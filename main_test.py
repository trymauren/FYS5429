import sys
import git
import numpy as np
from rnn.rnn import ReccurentNN
from utils.activations import Relu, Softmax

path_to_root = git.Repo('.', search_parent_directories=True).working_dir
sys.path.append(path_to_root)

rnn = ReccurentNN(Relu(), Softmax())
# y_true = np.array([[[1, 2, 3, 4, 5]], [[2, 3, 4, 5, 6]], [3, 4, 5, 6, 7]])
# x = np.array([[[0, 1, 2, 3, 4]], [[1, 2, 3, 4, 5]], [[2, 3, 4, 5, 6]]], dtype=float)
# y_true = np.array([[[1, 2], [1, 3]], [[1, 2], [1, 3]]])
# x = np.array([[[1, 2], [1, 3]], [[1, 2], [1, 3]]], dtype=float)
# y_true = np.array([[[1], [1]], [[1], [1]]])
# x = np.array([[[1], [1]], [[1], [1]]], dtype=float)

y_true = np.array([[[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[1, 1, 2, 2]],
                   [[2, 2, 3, 3]]], dtype=int)

x = np.array([[[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[0, 1, 2, 3]],
              [[1, 2, 3, 4]]], dtype=float)

rnn.fit(x, y_true, 100, 0.1)
